{% extends "base.html" %}
{% block content %}
<h3>Datasets</h3>
<table class="table table-bordered table-hover">
    <thead>
    <th>name</th>
    <th colspan="2">status / level</th>
    <th><i class="fa fa-play" aria-hidden="true"></i></th>
    <th>#</th>
    <th>description</th>
    <th>mode</th>
    <th>problem</th>
    <th>rows</th>
    <th>cols</th>
    <th colspan="3">actions</th>
    </thead>
    {% for dataset in datasets %}
    <tr>
        <td>
            <a href="/dataset/{{dataset.dataset_id}}" style="color:inherit; text-decoration: none;">{{
                dataset.name}}</a>
        </td>
        <td>
            <a href="/dataset/{{dataset.dataset_id}}" style="color:inherit; text-decoration: none;">
                {% if dataset.status == 'created' %}
                <span class="label label-default">created</span>
                {% elif dataset.status == 'searching' %}
                <span class="label label-warning">searching</span>
                {% elif dataset.status == 'pause' %}
                <span class="label label-info">pause</span>
                {% else %}
                <span class="label label-success">completed</span>
                {% endif %}
            </a>
        </td>
        <td>
            <a href="/dataset/{{dataset.dataset_id}}" style="color:inherit; text-decoration: none;">
                {% if dataset.status in ['searching', 'pause'] %}
                <div>
                    <span class="label label-primary">{{ dataset.level }}</span>
                </div>
                {% endif %}
            </a>
        </td>
        <td>
            {% if dataset.status in ['created', 'pause', 'completed'] %}
            <span data-toggle="tooltip" data-placement="left" title="start search">
                <a href="/start/{{dataset.dataset_id}}"><i class="fa fa-play" aria-hidden="true"></i></a></span>
            {% elif dataset.status == 'searching' %}
            <span data-toggle="tooltip" data-placement="left" title="pause search">
                <a href="/pause/{{dataset.dataset_id}}"><i class="fa fa-pause" aria-hidden="true"></i></a></span>
            {% endif %}
        </td>
        <td>
            <span class="label label-info">{{ dataset.results }}</span><br><span class="label label-default">{{ dataset.round_counter }}</span>
        </td>
        <td width="30%">
            <a href="/dataset/{{dataset.dataset_id}}" style="color:inherit; text-decoration: none;">{{dataset.description[:100]}}...</a>
        </td>
        <td>
            <a href="/dataset/{{dataset.dataset_id}}" style="color:inherit; text-decoration: none;">{{dataset.mode}}</a>
        </td>
        <td>
            <a href="/dataset/{{dataset.dataset_id}}" style="color:inherit; text-decoration: none;">{{dataset.problem_type}}</a>
        </td>
        <td>
            <a href="/dataset/{{dataset.dataset_id}}"
               style="color:inherit; text-decoration: none;">{{dataset.n_rows}}K</a>
        </td>
        <td>
            <a href="/dataset/{{dataset.dataset_id}}"
               style="color:inherit; text-decoration: none;">{{dataset.n_cols}}</a>
        </td>
        <td>
            <span data-toggle="tooltip" data-placement="left" title="edit dataset">
                <a href="/update/{{dataset.dataset_id}}" style="color:inherit; text-decoration: none;"><i
                        class="fa fa-pencil-square-o"></i></a></span>
        </td>
        <td>
            <span data-toggle="tooltip" data-placement="left" title="duplicate dataset">
                <a href="/duplicate/{{dataset.dataset_id}}" style="color:inherit; text-decoration: none;"><i
                        class="fa fa-files-o"></i></a></span>
        </td>
        <td>
            <span data-toggle="tooltip" data-placement="left" title="delete dataset"><a href="#DeleteModal"
                                                                                        class="open_DeleteModal"
                                                                                        style="color:inherit; text-decoration: none;"
                                                                                        data-toggle="modal"
                                                                                        data-target="#DeleteModal"
                                                                                        data-id="{{dataset.dataset_id}}"
                                                                                        data-name="{{dataset.name}}"
                                                                                        data-description="{{dataset.description}}">
                <i class="fa fa-trash-o" aria-hidden="true"></i></a></span>
        </td>
    </tr>
    {% endfor %}
</table>

<script type="text/javascript">
$(document).on("click", ".open_DeleteModal", function() {
$(".modal-body #id").val($(this).data('id'));
$(".modal-body #name").val($(this).data('name'));
$(".modal-body #description").val($(this).data('description'));
});

</script>

<!--
<div class="modal fade" id="DeleteModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
!-->
<div class="modal fade" id="DeleteModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">Are you sure you want to delete this dataset ?</h4>
            </div>
            <form role="form" action="/delete" method="POST" name="request" enctype="multipart/form-data">
                {{ del_form.hidden_tag() }}
                <div class="modal-body">
                    <div class="form-group">
                        <label>Id</label>
                        <input class="form-control" type="text" name="id" id="id" readonly>
                    </div>
                    <div class="form-group">
                        <label>Name</label>
                        <input class="form-control" type="text" name="name" id="name" readonly>
                    </div>
                    <div class="form-group">
                        <label>Description</label>
                        <textarea class="form-control" name="description" id="description" rows="3" readonly></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn_default" data-dismiss="modal">Cancel</button>
                    {{ del_form.submit }}
                    <input type="submit" class="btn btn_primary" value="Submit">
                </div>
            </form>
        </div>
    </div>
</div>

<script type="text/javascript">
    setInterval(function() {
      window.location.reload();
    }, 300000);

</script>
{% endblock %}
